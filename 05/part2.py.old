filename="input.txt"

def merge_range(a, b, ranges):
    ranges = ranges[:]

    if ranges == []:
        ranges += [a, b]
        return ranges

    if a<=ranges[0] and b==ranges[0]:
        ranges[0] = a
        return ranges 
    if a==ranges[-1] and b>=ranges[-1]:
        ranges[-1] = b 
        return ranges

    i=0
    while a>ranges[i]:
        i+=1
        if (i==len(ranges)):
            # a > end of LAST range 
            ranges += [a,b]
            return ranges

    if i % 2 == 0:
        # a <= start of a range
        j = i
        while b>ranges[j]:
            j+=1
            if j==len(ranges):
                # b > end of LAST range
                ranges = ranges[:i] + [a,b]
                return ranges
        
            
        if j % 2 == 0:
            # b <= start of a range
            if a==ranges[i] and b==ranges[j]:
                ranges = ranges[:i+1] + ranges[j+1:]
            else:
                ranges = ranges[:i] + [a,b] + ranges[j:]
        else:
            # b <= end of a range
            if a==ranges[i] and b==ranges[j]:
                ranges = ranges[:i+1] + ranges[j:]
            else:
                ranges = ranges[:i] + [a] + ranges[j:]
    else:
        # a <= end of a range
        j = i
        while b>ranges[j]:
            j+=1
            if j==len(ranges):
                # b > end of LAST range
                ranges = ranges[:i] + [b]
                return ranges
        if j % 2 == 0:
            # b <= start of a range
            if a==ranges[i] and b==ranges[j]:
                ranges = ranges[:i] + ranges[j+1:]
            else:
                ranges = ranges[:i] + [b] + ranges[j:]
        else:
            # b <= end of a range
            ranges = ranges[:i] + ranges[j:]
    return ranges

def calc_fresh_ingredients_from_unique_ranges(unique_ranges):
    i=0
    fresh_ingreds=0
    while i<len(unique_ranges):
        fresh_ingreds += unique_ranges[i+1] - unique_ranges[i] + 1
        i+=2
    return fresh_ingreds

def main():
    with open(filename, 'r') as f:
        ranges_uniq = []
        for line in f:
            line = line.strip()
            if line=='':
                break
            dash_i = line.find('-')
            a = int(line[:dash_i])
            b = int(line[dash_i+1 :])
            before = ranges_uniq[:]
            ranges_uniq = merge_range(a, b, ranges_uniq)
            after = ranges_uniq[:]
            print(before==after)
            print()
    print(ranges_uniq)

    print(calc_fresh_ingredients_from_unique_ranges(ranges_uniq))

def test():
    ranges = [3,5, 6,10, 12,15, 18,20]
    ranges_to_add = [(1,3),(1,4),(1,5),(20,23),(19,23),(16,23)]
    for i in range(len(ranges_to_add)):
        x,y = ranges_to_add[i]
        print(ranges)
        print(x,y)
        print(merge_range(x,y, ranges))
        print()

if __name__=="__main__":
    main() 
